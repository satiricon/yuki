parameters:
  ffmpeg_bin: '/usr/bin/ffmpeg'
  ffprobe_bin: '/usr/bin/ffprobe'
  metadata_resolve:
    - { regex: '/album_artist/i', value: 'artist' }

services:
  ffmpeg:
    class: FFMpeg\FFMpeg
    factory: ['FFMpeg\FFMpeg', create]
    arguments:
      - { ffmpeg.binaries: '%ffmpeg_bin%', ffprobe.binaries: '%ffprobe_bin%'}
  ffprobe:
    class: FFMpeg\FFProbe
    factory: 'ffmpeg:getFFProbe'
  yuki.media_storage:
    class: \Drupal\Core\Entity\Sql\SqlContentEntityStorage
    factory: 'entity_type.manager:getStorage'
    arguments: ['media']
  newfile_subscriber:
    class: \Drupal\yuki\Commands\EventSubscriber\NewFileSubscriber
    tags:
      - { name: 'event_subscriber' }
    calls:
      - method: setMediaStorage
        arguments:
          - "@yuki.media_storage"
